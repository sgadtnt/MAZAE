<!DOCTYPE html><html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>تسجيل الدخول / إنشاء حساب</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">  <div id="authModal" class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-md relative"><button onclick="window.history.back()" class="absolute top-2 left-2 text-sm text-gray-500 hover:underline">رجوع</button>

<div class="flex justify-center mb-4 space-x-4 space-x-reverse">
  <button id="showLogin" class="text-lg font-semibold border-b-2 border-blue-600">تسجيل الدخول</button>
  <button id="showSignup" class="text-lg font-semibold text-gray-500 hover:text-gray-800">إنشاء حساب</button>
</div>

<form id="loginForm" class="space-y-4">
  <div>
    <label class="block mb-1">البريد الإلكتروني</label>
    <input type="email" id="loginEmail" required class="w-full border rounded px-3 py-2" placeholder="أدخل بريدك">
  </div>
  <div>
    <label class="block mb-1">كلمة المرور</label>
    <div class="relative">
      <input type="password" id="loginPassword" required class="w-full border rounded px-3 py-2 pr-10" placeholder="••••••••">
      <button type="button" id="toggleLoginPassword" class="absolute inset-y-0 left-2 text-sm text-gray-500">عرض</button>
    </div>
  </div>
  <div class="text-left">
    <button type="button" id="showReset" class="text-sm text-blue-600 hover:underline">نسيت كلمة المرور؟</button>
  </div>
  <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">تسجيل الدخول</button>
</form>

<div class="my-4 border-t pt-4 text-center text-sm text-gray-400">أو</div>

<button id="googleSignInBtn" class="w-full border py-2 rounded text-gray-700 hover:bg-gray-50">تسجيل الدخول بحساب Google</button>
<button onclick="continueAsGuest()" class="w-full mt-3 bg-gray-200 text-gray-800 py-2 rounded hover:bg-gray-300">دخول كضيف</button>

<footer class="mt-6 text-center text-xs text-gray-400">
  للتواصل عبر واتساب: +96407823053419
</footer>

<form id="resetForm" class="space-y-4 hidden">
  <div>
    <label class="block mb-1">أدخل بريدك لإعادة تعيين كلمة المرور</label>
    <input type="email" id="resetEmail" required class="w-full border rounded px-3 py-2" placeholder="بريدك الإلكتروني">
  </div>
  <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">إرسال رابط إعادة التعيين</button>
  <button type="button" id="backToLoginFromReset" class="w-full mt-2 text-center text-sm text-gray-600 hover:underline">عودة لتسجيل الدخول</button>
</form>

<form id="signupForm" class="space-y-4 hidden">
  <div>
    <label class="block mb-1">اسم المستخدم</label>
    <input type="text" id="signupUsername" required class="w-full border rounded px-3 py-2" placeholder="مثلاً: سجاد">
  </div>
  <div>
    <label class="block mb-1">البريد الإلكتروني</label>
    <input type="email" id="signupEmail" required class="w-full border rounded px-3 py-2" placeholder="أدخل بريدك">
  </div>
  <div>
    <label class="block mb-1">كلمة المرور</label>
    <div class="relative">
      <input type="password" id="signupPassword" required class="w-full border rounded px-3 py-2 pr-10" placeholder="••••••••">
      <button type="button" id="toggleSignupPassword" class="absolute inset-y-0 left-2 text-sm text-gray-500">عرض</button>
    </div>
  </div>
  <div>
    <label class="block mb-1">تأكيد كلمة المرور</label>
    <div class="relative">
      <input type="password" id="confirmPassword" required class="w-full border rounded px-3 py-2 pr-10" placeholder="••••••••">
      <button type="button" id="toggleConfirmPassword" class="absolute inset-y-0 left-2 text-sm text-gray-500">عرض</button>
    </div>
  </div>
  <button type="submit" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700">إنشاء حساب</button>
  <button type="button" id="backToLoginFromSignup" class="w-full mt-2 text-center text-sm text-gray-600 hover:underline">عودة لتسجيل الدخول</button>
</form>

  </div>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAG4EKrB3iLEV2hsB8b08ShpSO6PXDnGjg",
      authDomain: "zio3-8ffdd.firebaseapp.com",
      projectId: "zio3-8ffdd",
      storageBucket: "zio3-8ffdd.appspot.com",
      messagingSenderId: "560939348415",
      appId: "1:560939348415:web:c854e9e214e498ad2d310a"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const provider = new firebase.auth.GoogleAuthProvider();

    document.getElementById('toggleLoginPassword').addEventListener('click', () => {
      const pw = document.getElementById('loginPassword');
      const type = pw.type === 'password' ? 'text' : 'password';
      pw.type = type;
      event.target.textContent = type === 'password' ? 'عرض' : 'إخفاء';
    });

    document.getElementById('toggleSignupPassword').addEventListener('click', () => {
      const pw = document.getElementById('signupPassword');
      const type = pw.type === 'password' ? 'text' : 'password';
      pw.type = type;
      event.target.textContent = type === 'password' ? 'عرض' : 'إخفاء';
    });

    document.getElementById('toggleConfirmPassword').addEventListener('click', () => {
      const pw = document.getElementById('confirmPassword');
      const type = pw.type === 'password' ? 'text' : 'password';
      pw.type = type;
      event.target.textContent = type === 'password' ? 'عرض' : 'إخفاء';
    });

    document.getElementById('showReset').addEventListener('click', () => {
      loginForm.classList.add('hidden'); resetForm.classList.remove('hidden');
    });
    document.getElementById('backToLoginFromReset').addEventListener('click', () => {
      resetForm.classList.add('hidden'); loginForm.classList.remove('hidden');
    });
    document.getElementById('showSignup').addEventListener('click', () => {
      loginForm.classList.add('hidden'); signupForm.classList.remove('hidden');
      showLogin.classList.remove('border-blue-600'); showLogin.classList.add('text-gray-500');
      showSignup.classList.add('border-blue-600'); showSignup.classList.remove('text-gray-500');
    });
    document.getElementById('backToLoginFromSignup').addEventListener('click', () => {
      signupForm.classList.add('hidden'); loginForm.classList.remove('hidden');
      showSignup.classList.remove('border-blue-600'); showSignup.classList.add('text-gray-500');
      showLogin.classList.add('border-blue-600'); showLogin.classList.remove('text-gray-500');
    });
    document.getElementById('showLogin').addEventListener('click', () => window.location.reload());

    loginForm.addEventListener('submit', e => {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const pass = document.getElementById('loginPassword').value;
      auth.signInWithEmailAndPassword(email, pass)
        .then(() => window.location.href = 'store.html')
        .catch(err => alert(err.message));
    });

    resetForm.addEventListener('submit', e => {
      e.preventDefault();
      const email = document.getElementById('resetEmail').value;
      auth.sendPasswordResetEmail(email)
        .then(() => alert('أرسلنا رابط إعادة التعيين إلى بريدك.'))
        .catch(err => alert(err.message));
    });

    signupForm.addEventListener('submit', e => {
      e.preventDefault();
      const username = document.getElementById('signupUsername').value;
      const email = document.getElementById('signupEmail').value;
      const pass = document.getElementById('signupPassword').value;
      const confirm = document.getElementById('confirmPassword').value;
      if (pass !== confirm) return alert('كلمتا المرور غير متطابقتين.');
      auth.createUserWithEmailAndPassword(email, pass)
        .then((userCredential) => {
          return userCredential.user.updateProfile({ displayName: username });
        })
        .then(() => window.location.href = 'store.html')
        .catch(err => alert(err.message));
    });

    document.getElementById('googleSignInBtn').addEventListener('click', () => {
      auth.signInWithPopup(provider)
        .then(() => window.location.href = 'store.html')
        .catch(err => alert(err.message));
    });

    function continueAsGuest() { window.location.href = 'store.html'; }
  </script></body>
</html>
